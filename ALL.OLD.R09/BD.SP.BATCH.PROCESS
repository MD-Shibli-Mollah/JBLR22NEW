*-----------------------------------------------------------------------------
* <Rating>-1</Rating>
*-----------------------------------------------------------------------------
    SUBROUTINE BD.SP.BATCH.PROCESS

!    PROGRAM BD.SP.BATCH.PROCESS
    $INSERT GLOBUS.BP I_COMMON
    $INSERT GLOBUS.BP I_EQUATE
    $INSERT SP.BP I_F.BD.H.SP.CATEGORY
    $INSERT SP.BP I_F.BD.H.SP.STOCK.ISSUE
    $INSERT SP.BP I_F.BD.H.SP.BATCH
    $INSERT GLOBUS.BP I_F.USER

    FN.SPCATG='F.BD.H.SP.CATEGORY'
    F.SPCATG=''
    FN.USER = "F.USER"
    F.USER = ""
    FN.SP.ISSUE='F.BD.H.SP.STOCK.ISSUE'
    F.SP.ISSUE=''
    Y.COUP.ED=''

    Y.SOURCE ="DM.OFS.SRC"

    RUNNING.UNDER.BATCH=1

    CALL OPF(FN.USER,F.USER)

    Y.INPUTER=R.NEW(SP.BCH.INPUTTER)
    Y.USER.ID=FIELD(Y.INPUTER,"_",2)
    CALL F.READ(FN.USER,Y.USER.ID,R.USER,F.USER,Y.ERR1)
    Y.SIGNON.NAME=R.USER<EB.USE.SIGN.ON.NAME>


    Y.RECV.DATE=R.NEW(SP.BCH.BATCH.DATE1)

    Y.START=R.NEW(SP.BCH.SCRIPT.START)

    Y.END=R.NEW(SP.BCH.SCRIPT.END)

    Y.FACE.VAL=R.NEW(SP.BCH.FACE.VALUE)

    Y.FREQUENCY=R.NEW(SP.BCH.FREQUENCY)
    Y.QUANTITY=R.NEW(SP.BCH.QUANTITY)
    Y.TYPE=R.NEW(SP.BCH.TYPE.OF.SP)

    Y.PREFIX=R.NEW(SP.BCH.PREFIX)

    Y.SP.SOURCE=R.NEW(SP.BCH.SOURCE.OF.SP)
    Y.SP.SOURCE="BB"
    Y.STATUS="RECEIVED FROM SOURCE"

    Y.COUP.ST=R.NEW(SP.BCH.COUPON.START)
    Y.COUP.ED=R.NEW(SP.BCH.COUPON.END)

    FOR I=Y.START TO Y.END
        Y.SCRIPT=I
        Y.SP.SL.ID=Y.TYPE:".":Y.PREFIX:".":Y.SCRIPT

        Y.MESSAGE="BD.H.SP.STOCK.ISSUE,LTINP/I/PROCESS,":Y.SIGNON.NAME:"//":ID.COMPANY:",":Y.SP.SL.ID:",SP.SL.ID=":Y.SP.SL.ID:",RECEIVING.DATE=":Y.RECV.DATE:",TYPE.OF.SP=":Y.TYPE:",SOURCE.OF.SP=":Y.SP.SOURCE:",SCRIPT.NO=":Y.SCRIPT:",PREFIX=":Y.PREFIX:",COUPON.START.NO=":Y.COUP.ST:",COUPON.END.NO=":Y.COUP.ED:",FREQUENCY=":Y.FREQUENCY:",FACE.VALUE=":Y.FACE.VAL:",STATUS=":Y.STATUS
! Y.MESSAGE="BD.H.SP.STOCK.ISSUE,LTINP/I/PROCESS,RASHED2010//":Y.ID.COMPANY:",,RECEIVING.DATE=":Y.RECV.DATE:",SOURCE.OF.SP=":Y.SP.SOURCE

        CALL OFS.GLOBUS.MANAGER(Y.SOURCE,Y.MESSAGE)

        RUNNING.UNDER.BATCH=0
        SENSITIVITY = ''
! Y.STATUSS = FIELD(FIELD(Y.MESSAGE,"/",3,1),",",1)

    NEXT I

    RETURN
END
