    PROGRAM FIND

    $INSERT GLOBUS.BP I_COMMON
    $INSERT GLOBUS.BP I_EQUATE
    $INSERT GLOBUS.BP I_F.ACCOUNT
    $INSERT GLOBUS.BP I_F.ACCOUNT.CREDIT.INT


    GOSUB INIT
    GOSUB OPENFILES
    GOSUB PROCESS

INIT:

    FN.AC="F.ACCOUNT"
    F.AC=" "
    FN.ACI="F.ACCOUNT.CREDIT.INT"
    F.ACI=""

    R.RID=""
    R.RIDD=""
    R.AC=""
    R.ACI=""
    Y.ERR=""
    Y.ERRR=""
    RETURN

OPENFILES:
    CALL OPF(FN.AC,F.AC)
    CALL OPF(FN.ACI,F.ACI)

    RETURN

PROCESS:
!    DEBUG
    Y.CNT = ''
    SEL.CMD = "SELECT ":FN.AC:" WITH CATEGORY EQ 6003 AND CO.CODE EQ BD0010012"
    CALL EB.READLIST(SEL.CMD,SEL.LIST,"",NO.OF.REC,RET.CODE)
    LOOP
        REMOVE R.RID FROM SEL.LIST SETTING POS
    WHILE  R.RID:POS

        CALL F.READ(FN.AC,R.RID,R.AC,F.AC,Y.ERR)

        ACCAT=R.AC<AC.CATEGORY>


        Y.DATA<-1>=R.RID
        SEL.CMND = "SELECT ":FN.ACI:" WITH @ID LIKE ":R.RID:"..."

        CALL EB.READLIST(SEL.CMND,SEL.LISTT,"",NO.OF.REC,RET.CODE)
        LOOP
            REMOVE R.RIDD FROM SEL.LISTT SETTING POSS
        WHILE  R.RIDD:POSS

            CALL F.READ(FN.ACI,R.RIDD,R.ACI,F.ACI,Y.ERRR)
            CR=R.ACI<IC.ACI.CR.INT.RATE>
            IF CR EQ 5.75 THEN
                PRINT "AC:":R.RIDD:" ":"INT:":CR
                Y.CNT = Y.CNT + 1
            END
        REPEAT

    REPEAT
    PRINT "COUNT :":Y.CNT
    RETURN
END
