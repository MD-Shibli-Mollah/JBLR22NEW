**************************************************
* ROUTINE TO GENERATE REPORT FOR ALL SINGLE BRANCHES
* DEV: ALIN BOBY
* DATE: 20161006
**************************************************
*    PROGRAM CUS.SUPP.3
    SUBROUTINE CUS.SUPP.3
    $INSERT GLOBUS.BP I_COMMON
    $INSERT GLOBUS.BP I_EQUATE
    $INSERT GLOBUS.BP I_F.COMPANY


*************READ THIS CAREFULLY BEFORE RUN THIS ROUTINE ***********************
*DEFINE THIS ROUTINE AS MAINLINE ROUTINE
*LOGIN IN CLASSIC MODE "BNK" AND RUN AS MAIN LINE ROUTINE
*"TSM" SHOULD BE AS "START" AND "BNK/OFS.MESSAGE.SERVICE" SHOULD BE "AUTO/START"
*IF "BNK/OFS.MESSAGE.SERVICE" IS COMITTED WITH "START" THEN START SERVICE MANAGER "START.TSM -DEBUG" IN DEBUG MODE AND START SERVICE MANUALLY.
*IF "BNK/OFS.MESSAGE.SERVICE" IS COMITTED WITH "AUTO" THEN SYSTEM BY DEFAULT TAKE CARE OF PROCESSING MESSAGE
*IRRESPECTIVE OF SERVICE MANAGER START WHETHER "DEBUG/PHANTOM" MODE
*USER SHOULD BE SUPER USER
*COMPANY LIST WILL BE TAKEN FROM COMPANY APPLICATION WHICH HAS SINGLE STATUS
*******************************************************************************

    GOSUB INIT
    GOSUB OPENFILES
    GOSUB PROCESS
    RETURN

INIT:

    FN.COMPANY = "F.COMPANY"
    F.COMPANY = ""
    RETURN

OPENFILES:

    CALL OPF(FN.COMPANY,F.COMPANY)
    RETURN

PROCESS:

    SEL.CMD='SELECT ':FN.COMPANY:' WITH LOCAL.REF EQ SINGLE'
    CALL EB.READLIST(SEL.CMD,SEL.LIST,'',NO.OF.REC,ERR)


    LOOP
        REMOVE COMP.ID FROM SEL.LIST SETTING ID.POS
    WHILE COMP.ID:ID.POS

        CALL LOAD.COMPANY(COMP.ID)
        GOSUB POST.OFS

    REPEAT
    RETURN

POST.OFS:


    Y.SOURCE="BUILD.CONTROL"
    Y.MESSAGE1 = "ENQUIRY.REPORT,CUS.SUPPLIMENT2.ITD.CD.DR/V/PROCESS,//":COMP.ID:",ER.CUS.SUPPLIMENT3"
    MSG.ID = ''
* Y.SOURCE="BUILD.CONTROL"
    CALL OFS.POST.MESSAGE(Y.MESSAGE1, MSG.ID , Y.SOURCE, "DMUSER")
    CALL JOURNAL.UPDATE ('TEST')

    Y.MESSAGE2 = "ENQUIRY.REPORT,CUS.SUPPLIMENT2.ITD.CD.DR/V/PROCESS,//":COMP.ID:",ER.CUS.SUP.CD.CR"
    MSG.ID = ''
    CALL OFS.POST.MESSAGE(Y.MESSAGE2, MSG.ID , Y.SOURCE, "DMUSER")
    CALL JOURNAL.UPDATE ('TEST')

    Y.MESSAGE3 = "ENQUIRY.REPORT,CUS.SUPPLIMENT2.ITD.CD.DR/V/PROCESS,//":COMP.ID:",ER.CUS.SUP.SB.DR"
    MSG.ID = ''
    CALL OFS.POST.MESSAGE(Y.MESSAGE3, MSG.ID , Y.SOURCE, "DMUSER")
    CALL JOURNAL.UPDATE ('TEST')

    Y.MESSAGE4 = "ENQUIRY.REPORT,CUS.SUPPLIMENT2.ITD.CD.DR/V/PROCESS,//":COMP.ID:",ER.CUS.SUP.SB.CR"
    MSG.ID = ''
    CALL OFS.POST.MESSAGE(Y.MESSAGE4, MSG.ID , Y.SOURCE, "DMUSER")
    CALL JOURNAL.UPDATE ('TEST')

    Y.MESSAGE5 = "ENQUIRY.REPORT,CUS.SUPPLIMENT2.ITD.CD.DR/V/PROCESS,//":COMP.ID:",ER.CUS.SUP.STD.DR"
    MSG.ID = ''
    CALL OFS.POST.MESSAGE(Y.MESSAGE5, MSG.ID , Y.SOURCE, "DMUSER")
    CALL JOURNAL.UPDATE ('TEST')

    Y.MESSAGE6 = "ENQUIRY.REPORT,CUS.SUPPLIMENT2.ITD.CD.DR/V/PROCESS,//":COMP.ID:",ER.CUS.SUP.STD.CR"
    MSG.ID = ''
    CALL OFS.POST.MESSAGE(Y.MESSAGE6, MSG.ID , Y.SOURCE, "DMUSER")
    CALL JOURNAL.UPDATE ('TEST')

*    Y.MESSAGE7 = "ENQUIRY.REPORT,CASH.BOOK.DAILY/V/PROCESS,//":COMP.ID:",ER.CASH.BOOK2"
*    MSG.ID = ''
*    Y.SOURCE="BUILD.CONTROL"
*    CALL OFS.POST.MESSAGE(Y.MESSAGE7, MSG.ID , Y.SOURCE, "DMUSER")
*    CALL JOURNAL.UPDATE ('TEST')


    RETURN

END
