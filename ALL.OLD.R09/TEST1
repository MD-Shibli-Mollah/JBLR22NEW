    PROGRAM TEST1
    $INSERT GLOBUS.BP I_COMMON
    $INSERT GLOBUS.BP I_EQUATE
    $INSERT JBL.BP I_F.BD.SDSA.AC.REFNO
    $INSERT JBL.BP I_F.BD.SDSA.ENTRY.DETAILS

    FN.SD.REF = 'F.BD.SDSA.AC.REFNO'
    F.SD.REF =''
    FN.SD.DET = 'F.BD.SDSA.ENTRY.DETAILS'
    F.SD.DET = ''

    CALL OPF(FN.SD.REF,F.SD.REF)
    CALL OPF(FN.SD.DET,F.SD.DET)
    I = 0
    SEL.CMD ="SELECT ":FN.SD.DET
    CALL EB.READLIST(SEL.CMD,SEL.LIST,'',NO.OF.REC,RET.CODE)
    LOOP
        REMOVE Y.ID FROM SEL.LIST SETTING POS
    WHILE Y.ID:POS

!        Y.ID = 'NARGIS06122018'
        CALL F.READ(FN.SD.DET,Y.ID,R.DET,F.SD.DET,Y.ERR.SD.DET)
        Y.DET.ID = Y.ID
        Y.AC.NO = R.DET<BD.SDSA.AC.NUMBER>
        TEMP.1 = 'NA'
        Y.ACT.WITH.YR = Y.AC.NO:'-18'
        CALL F.READ(FN.SD.REF,Y.ACT.WITH.YR,R.SD.REF,F.SD.REF,Y.SD.REF.ERR)
        FIND Y.DET.ID IN R.SD.REF SETTING POS, POS1, POS3 THEN
            IF POS1 GT 1 THEN
                TEMP.1 = Y.ACT.WITH.YR
            END

        END ELSE

            Y.ACT.WITH.YR = Y.AC.NO:'-19'
            CALL F.READ(FN.SD.REF,Y.ACT.WITH.YR,R.SD.REF,F.SD.REF,Y.SD.REF.ERR)
            FIND Y.DET.ID IN R.SD.REF SETTING POS, POS1, POS3 THEN
                IF POS1 GT 1 THEN
                    TEMP.1 = Y.ACT.WITH.YR
                END
            END

        END



        Y.AC.NO = R.DET<BD.SDSA.AC.NUMBER>
        Y.AC.TYPE = R.DET<BD.SDSA.AC.TYPE>
        Y.CO.CODE = R.DET<BD.SDSA.CO.CODE>
        CRT  Y.DET.ID:'*':TEMP.1:'*':Y.AC.NO:'*':Y.AC.TYPE:'*':Y.CO.CODE
        I++
    REPEAT
    CRT I
END
