    SUBROUTINE URM.AUTO.FIELD.8

    $INSERT GLOBUS.BP I_COMMON
    $INSERT GLOBUS.BP I_EQUATE
    $INSERT GLOBUS.BP I_F.USER
    $INSERT BP I_F.USER.MGT


    FN.UM = 'F.EB.USER.MGT'
    F.UM = ''

    FN.U='F.USER'
    F.U=''

    Y.UM.ID = ''
    R.UM = ''
    Y.UM.ERR = ''

    CALL OPF (FN.UM, F.UM)
    CALL OPF(FN.U, F.U)

    Y.VER.ID=APPLICATION:PGM.VERSION
    IF Y.VER.ID EQ "EB.USER.MGT,AMEND" THEN
        Y.UM.ID=ID.NEW
        CALL F.READ(FN.UM,Y.UM.ID,R.UM,F.UM,Y.UM.ERR)
        R.NEW(EB.USE61.REQUEST.FOR)="AMEND"
    END
    ELSE IF Y.VER.ID EQ "EB.USER.MGT,CLOSE" THEN
        Y.UM.ID=ID.NEW
        CALL F.READ(FN.UM,Y.UM.ID,R.UM,F.UM,Y.UM.ERR)
        R.NEW(EB.USE61.REQUEST.FOR)="CLOSE"
    END
    ELSE IF Y.VER.ID EQ "EB.USER.MGT,REVOKE" THEN
        Y.UM.ID=ID.NEW
        CALL F.READ(FN.UM,Y.UM.ID,R.UM,F.UM,Y.UM.ERR)
        R.NEW(EB.USE61.REQUEST.FOR)="REOPEN"
    END
    ELSE IF Y.VER.ID EQ "EB.USER.MGT,PASSWORD.RESET" THEN
        Y.UM.ID=ID.NEW
        CALL F.READ(FN.UM,Y.UM.ID,R.UM,F.UM,Y.UM.ERR)
        R.NEW(EB.USE61.REQUEST.FOR)="PASSWORD.RESET"
    END
    ELSE IF Y.VER.ID EQ "USER,AMEND" THEN
        Y.USER.ID=ID.NEW
        Y.BANK.ID=RIGHT(LEFT(Y.USER.ID,8),6)
        CALL F.READ(FN.U,Y.USER.ID,REC.USER,F.U,ERROR.USER)
        IF REC.USER NE '' THEN
            SEL.CMD="SELECT ":FN.UM:" WITH USER.ID EQ ":Y.USER.ID
        END
        ELSE
            SEL.CMD="SELECT ":FN.UM:" WITH EMP.BANK.ID EQ ":Y.BANK.ID
        END
        CALL EB.READLIST(SEL.CMD,SEL.LIST,"",NO.OF.RECORDS,RET.CODE)
        REMOVE Y.UM.ID FROM SEL.LIST SETTING POS
        CALL F.READ(FN.UM,Y.UM.ID,R.UM,F.UM,Y.UM.ERR)
        R.NEW(EB.USE.END.DATE.PROFILE)=R.UM<EB.USE61.CLOSE.APPLY.DATE>
    END

    ELSE IF Y.VER.ID EQ "USER,TRANSFER" THEN
        Y.USER.ID=ID.NEW
        Y.BANK.ID=RIGHT(LEFT(Y.USER.ID,8),6)
        CALL F.READ(FN.U,Y.USER.ID,REC.USER,F.U,ERROR.USER)
        IF REC.USER NE '' THEN
            SEL.CMD="SELECT ":FN.UM:" WITH USER.ID EQ ":Y.USER.ID
        END
        ELSE
            SEL.CMD="SELECT ":FN.UM:" WITH EMP.BANK.ID EQ ":Y.BANK.ID
        END
        CALL EB.READLIST(SEL.CMD,SEL.LIST,"",NO.OF.RECORDS,RET.CODE)
        REMOVE Y.UM.ID FROM SEL.LIST SETTING POS
        CALL F.READ(FN.UM,Y.UM.ID,R.UM,F.UM,Y.UM.ERR)
        R.NEW(EB.USE.END.DATE.PROFILE)=R.UM<EB.USE61.CLOSE.APPLY.DATE>
        R.NEW(EB.USE.COMPANY.CODE)=R.UM<EB.USE61.ATTRIBUTE1>
        R.NEW(EB.USE.COMPANY.RESTR)=R.UM<EB.USE61.ATTRIBUTE1>
    END

    ELSE IF Y.VER.ID EQ "EB.USER.MGT,TRANSFER" THEN
        Y.UM.ID=ID.NEW
        CALL F.READ(FN.UM,Y.UM.ID,R.UM,F.UM,Y.UM.ERR)
        R.NEW(EB.USE61.REQUEST.FOR)="TRANSFER"
        R.NEW(EB.USE61.ATTRIBUTE1)=""
        R.NEW(EB.USE61.CLOSE.APPLY.DATE)=""
    END


    RETURN
