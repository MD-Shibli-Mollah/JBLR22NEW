    SUBROUTINE CUS.SUPP.2
    $INSERT GLOBUS.BP I_COMMON
    $INSERT GLOBUS.BP I_EQUATE
    $INSERT GLOBUS.BP I_F.COMPANY

*DEV BY - MR. HURAIRA
*UPDATED BY - ALIN BOBY (20151202)
*DEFINE THIS ROUTINE AS MAINLINE ROUTINE
*LOGIN IN CLASSIC MODE "BNK" AND RUN AS MAIN LINE ROUTINE
*"TSM" SHOULD BE AS "START" AND "BNK/OFS.MESSAGE.SERVICE" SHOULD BE "AUTO/START"
*IF "BNK/OFS.MESSAGE.SERVICE" IS COMITTED WITH "START" THEN START SERVICE MANAGER "START.TSM -DEBUG" IN DEBUG MODE AND START SERVICE MANUALLY.
*IF "BNK/OFS.MESSAGE.SERVICE" IS COMITTED WITH "AUTO" THEN SYSTEM BY DEFAULT TAKE CARE OF PROCESSING MESSAGE
*IRRESPECTIVE OF SERVICE MANAGER START WHETHER "DEBUG/PHANTOM" MODE
*USER SHOULD BE SUPER USER
*&SAVEDLISTS& FILE NAME IS "COMPANY.ID.LIST"

    GOSUB INIT
    GOSUB OPENFILES
    GOSUB PROCESS
    RETURN

INIT:

    FN.COMPANY = "F.COMPANY"
    F.COMPANY = ""
    RETURN

OPENFILES:
!DEBUG
    OPEN "&SAVEDLISTS&" TO F.SAVEDLISTS ELSE
        TEXT ="CANNOT OPEN SAVEDLISTS,PRESS ANY KEY TO EXIT"
        CRT TEXT
        INPUT USER.CHOICE1
        RETURN
    END
    CALL OPF(FN.COMPANY,F.COMPANY)
    RETURN

PROCESS:

    READ RCC.IDS FROM F.SAVEDLISTS,"COMPANY.ID.LIST" ELSE
        TEXT ="CANNOT READ FILE NAME 'COMPANY.ID.LIST' FROM SAVEDLISTS,PRESS ANY KEY TO EXIT"
        CRT TEXT
        INPUT USER.CHOICE2
        RETURN
    END

    LOOP
        REMOVE COMPANY.REC FROM RCC.IDS SETTING ID.POS
    WHILE COMPANY.REC:ID.POS
        COMP.ID = TRIM(COMPANY.REC)
        CALL F.READ(FN.COMPANY,COMP.ID,COMPANY.LIST,F.COMPANY,Y.CO.ERR)
        IF COMPANY.LIST THEN
            CALL LOAD.COMPANY(COMP.ID)
            GOSUB POST.OFS
        END
        IF NOT(COMPANY.LIST) THEN
            TEXT ="COMANY CODE ":COMP.ID:" IS MISSING. DO YOU WANT TO CONTINUE?(Y/N)"
            CRT TEXT
            INPUT USER.CHOICE3
            IF USER.CHOICE3 EQ "Y" THEN
                CONTINUE
            END ELSE
                BREAK
            END
        END
    REPEAT
    RETURN

POST.OFS:

*IF INPUT VALUE PASS THROUGH MESSAGE
*Y.MESSAGE = "ENQUIRY.REPORT,CUS.SUPPLIMENT/V/PROCESS,//":COMP.ID:",ER.CUS.SUPPLIMENT,LIST:1:1=ALL,LIST:1:2=DEBIT,LIST:1:3=ALL,LIST:1:4=ALL"
*CALL OFS.POST.MESSAGE(Y.MESSAGE,I.MSG.ID,"DM.OFS.SRC.VAL","DMUSER")
*CALL JOURNAL.UPDATE ('TEST')
*************END************

*IF INPUT VALUE FIXED IN THE VERSION

    Y.SOURCE="BUILD.CONTROL"
!    Y.MESSAGE1 = "ENQUIRY.REPORT,CUS.SUPPLIMENT2.ITD.CD.DR/V/PROCESS,//":COMP.ID:",ER.CUS.SUPPLIMENT3"
!   MSG.ID = ''

!  CALL OFS.POST.MESSAGE(Y.MESSAGE1, MSG.ID , Y.SOURCE, "DMUSER")
! CALL JOURNAL.UPDATE ('TEST')

    Y.MESSAGE2 = "ENQUIRY.REPORT,TRANS.REG/V/PROCESS,//":COMP.ID:",JBL.COB.TRANSFER.REG"
    MSG.ID = ''
    CALL OFS.POST.MESSAGE(Y.MESSAGE2, MSG.ID , Y.SOURCE, "DMUSER")
    CALL JOURNAL.UPDATE ('TEST')

*    Y.MESSAGE7 = "ENQUIRY.REPORT,CASH.BOOK.DAILY/V/PROCESS,//":COMP.ID:",ER.CASH.BOOK2"
*    MSG.ID = ''
*    Y.SOURCE="BUILD.CONTROL"
*    CALL OFS.POST.MESSAGE(Y.MESSAGE7, MSG.ID , Y.SOURCE, "DMUSER")
*    CALL JOURNAL.UPDATE ('TEST')


    RETURN

END
