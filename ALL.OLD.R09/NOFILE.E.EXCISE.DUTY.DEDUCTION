*-----------------------------------------------------------------------------
* <Rating>1574</Rating>
*-----------------------------------------------------------------------------
*--------------------------------------------------------------------------------------------------
    SUBROUTINE NOFILE.E.EXCISE.DUTY.DEDUCTION(Y.ARR)
*--------------------------------------------------------------------------------------------------
* This is a Nofile Enquiry used to display the number of accounts for which the Excise Duty amount
* is been deducted
*
* @author               - emmanuel.livingston@capgemini.com
*
*--------------------------------------------------------------------------------------------------
* Modification History:
*--------------------------------------------------------------------------------------------------
*
* 12/08/2011            -Janatha Bank Limited
*                       -New Changes
*
*--------------------------------------------------------------------------------------------------
*
*
    $INSERT GLOBUS.BP I_COMMON
    $INSERT GLOBUS.BP I_EQUATE
    $INSERT GLOBUS.BP I_ENQUIRY.COMMON
    $INSERT GLOBUS.BP I_F.ACCOUNT
    $INSERT GLOBUS.BP I_F.CATEGORY
    $INSERT JBL.BP I_F.EB.BD.EXCISE.DUTY
    $INSERT JBL.BP I_F.EB.BD.EXCISE.DUTY.PARAM
    $INSERT BP I_F.BD.EXCISE.DUTY.SLAB
*
*--------------------------------------------------------------------------------------------------
* Main Controlling Section:
*--------------------------------------------------------------------------------------------------
*
*
    GOSUB INITIALISATION
    GOSUB MAIN.PROCESS
*
    RETURN
*
*--------------------------------------------------------------------------------------------------
* Subroutine Section:
*--------------------------------------------------------------------------------------------------
*
INITIALISATION:
*--------------------------------------------------------------------------------------------------
* File opening and Variable Set up
*--------------------------------------------------------------------------------------------------
*
    FN.ACCOUNT = 'F.ACCOUNT'
    F.ACCOUNT =''
    R.ACCOUNT = ''
    CALL OPF(FN.ACCOUNT,F.ACCOUNT)
*
    FN.EB.BD.EXCISE.DUTY = 'F.EB.BD.EXCISE.DUTY'
    F.EB.BD.EXCISE.DUTY =''
    R.EB.BD.EXCISE.DUTY =''
    CALL OPF(FN.EB.BD.EXCISE.DUTY,F.EB.BD.EXCISE.DUTY)
*
    FN.EB.BD.EXCISE.DUTY.SLAB = 'F.EB.BD.EXCISE.DUTY.SLAB'
    F.EB.BD.EXCISE.DUTY.SLAB = ''
    R.EB.BD.EXCISE.DUTY.SLAB = ''
    CALL OPF(FN.EB.BD.EXCISE.DUTY.SLAB,F.EB.BD.EXCISE.DUTY.SLAB)
*
    FN.EB.BD.EXCISE.DUTY.PARAM = 'F.EB.BD.EXCISE.DUTY.PARAM'
    F.EB.BD.EXCISE.DUTY.PARAM = ''
    R.EB.BD.EXCISE.DUTY.PARAM = ''
    CALL OPF(FN.EB.BD.EXCISE.DUTY.PARAM,F.EB.BD.EXCISE.DUTY.PARAM)
*
    FN.CATEGORY ='F.CATEGORY'
    F.CATEGORY =''
    R.CATEGORY =''
    CALL OPF(FN.CATEGORY,F.CATEGORY)
*
    Y.EXCISE.DUTY.SLAB.ID = 'SYSTEM'
    Y.EXCISE.DUTY.PARAM.ID ='AC'
*
    RETURN
*
*--------------------------------------------------------------------------------------------------
MAIN.PROCESS:
*--------------------------------------------------------------------------------------------------
*
*Main Subroutine Processing:
*
*--------------------------------------------------------------------------------------------------
*
    LOCATE "EXCISE.YEAR" IN  D.FIELDS SETTING POS ELSE NULL
    Y.DATE.RANGE = D.RANGE.AND.VALUE<POS>
*
    SEL.CMD.EX.DTY ='SELECT ':FN.EB.BD.EXCISE.DUTY:' WITH @ID LIKE ...':Y.DATE.RANGE
    CALL EB.READLIST(SEL.CMD.EX.DTY,SEL.LIST.EX.DTY,"",NO.OF.REC,Y.ERR)
*
    GOSUB RANGE.AMOUNT.AND.CATEGORY.SELECTION
    GOSUB ACCOUNT.COUNT
    GOSUB RECORDS.COUNT
*
*--------------------------------------------------------------------------------------------------
RANGE.AMOUNT.AND.CATEGORY.SELECTION:
*--------------------------------------------------------------------------------------------------
* In this Section the Various ranges for which Excise duty to be collected is been classified and
* the amount for each ranges are been assigned
*--------------------------------------------------------------------------------------------------
*
*
    CALL F.READ(FN.EB.BD.EXCISE.DUTY.SLAB,Y.EXCISE.DUTY.SLAB.ID,R.EB.BD.EXCISE.DUTY.SLAB,F.EB.BD.EXCISE.DUTY.SLAB,Y.ERR)
    Y.EXCISE.DUTY.AMT.FROM = R.EB.BD.EXCISE.DUTY.SLAB<EB.BD.2.AMT.FROM>
    Y.EXCISE.DUTY.AMT.TO   = R.EB.BD.EXCISE.DUTY.SLAB<EB.BD.2.AMT.TO>
    Y.EXCISE.DUTY.AMT.RATE = R.EB.BD.EXCISE.DUTY.SLAB<EB.BD.2.EXCISE.DUTY.AMT>
    Y.RATE.ALL.RANGE =  R.EB.BD.EXCISE.DUTY.SLAB<EB.BD.2.EXCISE.DUTY.AMT>
    Y.EXCISE.RANGE = DCOUNT(Y.EXCISE.DUTY.AMT.TO,@VM)
*
    Y.FIRST.RANGE.AMOUNT.FROM = FIELD(Y.EXCISE.DUTY.AMT.FROM,@VM,1,1)
    Y.FIRST.RANGE.AMOUNT.TO = FIELD(Y.EXCISE.DUTY.AMT.TO,@VM,1,1)
    Y.FIRST.RANGE = "tk upto ":Y.FIRST.RANGE.AMOUNT.TO
    Y.RATE.FIRST.RANGE = FIELD(Y.RATE.ALL.RANGE,@VM,1,1)
*
    Y.SECOND.RANGE.AMOUNT.FROM = FIELD(Y.EXCISE.DUTY.AMT.FROM,@VM,2,1)
    Y.SECOND.RANGE.AMOUNT.TO = FIELD(Y.EXCISE.DUTY.AMT.TO,@VM,2,1)
    Y.SECOND.RANGE = "tk ":Y.SECOND.RANGE.AMOUNT.FROM:" to tk ":Y.SECOND.RANGE.AMOUNT.TO
    Y.RATE.SECOND.RANGE = FIELD(Y.RATE.ALL.RANGE,@VM,2,1)
*
    Y.THIRD.RANGE.AMOUNT.FROM = FIELD(Y.EXCISE.DUTY.AMT.FROM,@VM,3,1)
    Y.THIRD.RANGE.AMOUNT.TO = FIELD(Y.EXCISE.DUTY.AMT.TO,@VM,3,1)
    Y.THIRD.RANGE = "tk ":Y.THIRD.RANGE.AMOUNT.FROM:" to tk ":Y.THIRD.RANGE.AMOUNT.TO
    Y.RATE.THIRD.RANGE = FIELD(Y.RATE.ALL.RANGE,@VM,3,1)
*
    Y.FOURTH.RANGE.AMOUNT.FROM = FIELD(Y.EXCISE.DUTY.AMT.FROM,@VM,4,1)
    Y.FOURTH.RANGE.AMOUNT.TO = FIELD(Y.EXCISE.DUTY.AMT.TO,@VM,4,1)
    Y.FOURTH.RANGE = "tk ":Y.FOURTH.RANGE.AMOUNT.FROM:" to tk ":Y.FOURTH.RANGE.AMOUNT.TO
    Y.RATE.FOURTH.RANGE = FIELD(Y.RATE.ALL.RANGE,@VM,4,1)
*
    Y.FIFTH.RANGE.AMOUNT.FROM = FIELD(Y.EXCISE.DUTY.AMT.FROM,@VM,5,1)
    Y.FIFTH.RANGE.AMOUNT.TO = FIELD(Y.EXCISE.DUTY.AMT.TO,@VM,5,1)
    Y.FIFTH.RANGE = "tk ":Y.FIFTH.RANGE.AMOUNT.FROM:" to tk ":Y.FIFTH.RANGE.AMOUNT.TO
    Y.RATE.FIFTH.RANGE = FIELD(Y.RATE.ALL.RANGE,@VM,5,1)
*
    Y.SIXTH.RANGE.AMOUNT.FROM = FIELD(Y.EXCISE.DUTY.AMT.FROM,@VM,6,1)
    Y.SIXTH.RANGE.AMOUNT.TO = FIELD(Y.EXCISE.DUTY.AMT.TO,@VM,6,1)
    Y.SIXTH.RANGE = "tk ":Y.SIXTH.RANGE.AMOUNT.FROM:" and above"
    Y.RATE.SIXTH.RANGE = FIELD(Y.RATE.ALL.RANGE,@VM,6,1)
*
    CALL F.READ(FN.EB.BD.EXCISE.DUTY.PARAM,Y.EXCISE.DUTY.PARAM.ID,R.EB.BD.EXCISE.DUTY.PARAM,F.EB.BD.EXCISE.DUTY.PARAM,Y.ERR)
    Y.PARAM.CATEGORY.FROM = R.EB.BD.EXCISE.DUTY.PARAM<EB.BD.30.INCLUDE.CAT.FRM>
    Y.PARAM.CATEGORY.TO =  R.EB.BD.EXCISE.DUTY.PARAM<EB.BD.30.INCLUDE.CAT.TO>
*
*
*--------------------------------------------------------------------------------------------------
* The Categories of Current account,Savings account and Term Deposit accounts are been classified
*--------------------------------------------------------------------------------------------------
*
    Y.CURR.CATEGORY.FIRST.FROM = FIELD(Y.PARAM.CATEGORY.FROM,@VM,1,1)
    Y.CURR.CATEGORY.FIRST.TO = FIELD(Y.PARAM.CATEGORY.TO,@VM,1,1)
*
*
    Y.SAVE.CATEGORY.FIRST.FROM = FIELD(Y.PARAM.CATEGORY.FROM,@VM,2,1)
    Y.SAVE.CATEGORY.FIRST.TO   = FIELD(Y.PARAM.CATEGORY.TO,@VM,2,1)
*
    Y.SAVE.CATEGORY.SECOND.FROM = FIELD(Y.PARAM.CATEGORY.FROM,@VM,3,1)
    Y.SAVE.CATEGORY.SECOND.TO = FIELD(Y.PARAM.CATEGORY.TO,@VM,3,1)
*
*
    Y.TD.CATEGORY.FIRST.FROM = FIELD(Y.PARAM.CATEGORY.FROM,@VM,4,1)
    Y.TD.CATEGORY.FIRST.TO = FIELD(Y.PARAM.CATEGORY.TO,@VM,4,1)
*
    Y.TD.CATEGORY.SECOND.FROM = FIELD(Y.PARAM.CATEGORY.FROM,@VM,5,1)
*
    Y.TD.CATEGORY.THIRD.FROM = FIELD(Y.PARAM.CATEGORY.FROM,@VM,6,1)
    Y.TD.CATEGORY.THIRD.TO = FIELD(Y.PARAM.CATEGORY.TO,@VM,6,1)
*--------------------------------------------------------------------------------------------------
* The Category which should be Excluded is Classified
*--------------------------------------------------------------------------------------------------
*
    Y.PARAM.CATEGORY.EXCLUDE.FROM = R.EB.BD.EXCISE.DUTY.PARAM<EB.BD.30.EXCLUDE.CAT.FRM>
    Y.PARAM.CATEGORY.EXCLUDE.TO = R.EB.BD.EXCISE.DUTY.PARAM<EB.BD.30.EXCLUDE.CAT.TO>
*
    Y.CATEGORY.EXCLUDE.FROM.FIRST = FIELD(Y.PARAM.CATEGORY.EXCLUDE.FROM,@VM,1,1)
    Y.CATEGORY.EXCLUDE.TO.FIRST = FIELD(Y.PARAM.CATEGORY.EXCLUDE.TO,@VM,2,1)

    Y.CATEGORY.EXCLUDE.FROM.SECOND = FIELD(Y.PARAM.CATEGORY.EXCLUDE.FROM,@VM,2,1)
*
    RETURN
*
*--------------------------------------------------------------------------------------------------
ACCOUNT.COUNT:
*--------------------------------------------------------------------------------------------------
* In this section we calculate the number of Current,Saving and Term Deposit Account for which
* Excise duty is been calculated
*--------------------------------------------------------------------------------------------------
*
*
    Y.CURR.FIRST.COUNT.RANGE = Y.CURR.SECOND.COUNT.RANGE = Y.CURR.THIRD.COUNT.RANGE = Y.CURR.FOURTH.COUNT.RANGE = Y.CURR.FIFTH.COUNT.RANGE = Y.CURR.SIXTH.COUNT.RANGE = ''
    Y.SAVE.FIRST.COUNT.RANGE = Y.SAVE.SECOND.COUNT.RANGE = Y.SAVE.THIRD.COUNT.RANGE = Y.SAVE.FOURTH.COUNT.RANGE = Y.SAVE.FIFTH.COUNT.RANGE = Y.SAVE.SIXTH.COUNT.RANGE = ''
    Y.TD.FIRST.COUNT.RANGE = Y.TD.SECOND.COUNT.RANGE = Y.TD.THIRD.COUNT.RANGE = Y.TD.FOURTH.COUNT.RANGE = Y.TD.FIFTH.COUNT.RANGE = Y.TD.SIXTH.COUNT.RANGE = ''
*
    LOOP
        REMOVE Y.EXCISE.DUTY.ID FROM SEL.LIST.EX.DTY SETTING Y.POS
    WHILE Y.EXCISE.DUTY.ID:Y.POS
*
        Y.EXCISE.DUTY.ACCT.ID = FIELD(Y.EXCISE.DUTY.ID,"-",1,1)
        CALL F.READ(FN.ACCOUNT,Y.EXCISE.DUTY.ACCT.ID,R.ACCOUNT,F.ACCOUNT,Y.ERR)
*
        Y.BALANCE = R.ACCOUNT<AC.WORKING.BALANCE>
        Y.CATEGORY = R.ACCOUNT<AC.CATEGORY>
*
        BEGIN CASE
*
*--------------------------------------------------------------------------------------------------
*


        CASE Y.BALANCE LE Y.FIRST.RANGE.AMOUNT.TO

            BEGIN CASE
*
            CASE Y.CATEGORY GE Y.CURR.CATEGORY.FIRST.FROM AND Y.CATEGORY LE Y.CURR.CATEGORY.FIRST.TO
                IF Y.CATEGORY NE Y.CATEGORY.EXCLUDE.FROM.FIRST AND Y.CATEGORY NE Y.CATEGORY.EXCLUDE.TO.FIRST AND Y.CATEGORY NE Y.CATEGORY.EXCLUDE.FROM.SECOND THEN
                    Y.CURR.FIRST.COUNT.RANGE = Y.CURR.FIRST.COUNT.RANGE + 1
                END
*
            CASE Y.CATEGORY GE Y.SAVE.CATEGORY.FIRST.FROM AND Y.CATEGORY LE Y.SAVE.CATEGORY.FIRST.TO OR Y.CATEGORY GE Y.SAVE.CATEGORY.SECOND.FROM AND Y.CATEGORY LE Y.SAVE.CATEGORY.SECOND.TO
                IF Y.CATEGORY NE Y.CATEGORY.EXCLUDE.FROM.FIRST AND Y.CATEGORY NE Y.CATEGORY.EXCLUDE.TO.FIRST AND Y.CATEGORY NE Y.CATEGORY.EXCLUDE.FROM.SECOND THEN
                    Y.SAVE.FIRST.COUNT.RANGE = Y.SAVE.FIRST.COUNT.RANGE + 1
                END
*
            CASE Y.CATEGORY GE Y.TD.CATEGORY.FIRST.FROM AND Y.CATEGORY LE Y.TD.CATEGORY.FIRST.TO OR Y.CATEGORY EQ Y.TD.CATEGORY.SECOND.FROM OR Y.CATEGORY GE Y.TD.CATEGORY.THIRD.FROM AND Y.CATEGORY LE Y.TD.CATEGORY.THIRD.TO
                IF Y.CATEGORY NE Y.CATEGORY.EXCLUDE.FROM.FIRST AND Y.CATEGORY NE Y.CATEGORY.EXCLUDE.TO.FIRST AND Y.CATEGORY NE Y.CATEGORY.EXCLUDE.FROM.SECOND THEN
                    Y.TD.FIRST.COUNT.RANGE = Y.TD.FIRST.COUNT.RANGE + 1
                END
*
            END CASE
*
*
*--------------------------------------------------------------------------------------------------
*
        CASE Y.BALANCE GE Y.SECOND.RANGE.AMOUNT.FROM AND Y.BALANCE LE Y.SECOND.RANGE.AMOUNT.TO
*
            BEGIN CASE
*
            CASE Y.CATEGORY GE Y.CURR.CATEGORY.FIRST.FROM AND Y.CATEGORY LE Y.CURR.CATEGORY.FIRST.TO
                IF Y.CATEGORY NE Y.CATEGORY.EXCLUDE.FROM.FIRST AND Y.CATEGORY NE Y.CATEGORY.EXCLUDE.TO.FIRST AND Y.CATEGORY NE Y.CATEGORY.EXCLUDE.FROM.SECOND THEN
                    Y.CURR.SECOND.COUNT.RANGE = Y.CURR.SECOND.COUNT.RANGE + 1
                END
*
            CASE Y.CATEGORY GE Y.SAVE.CATEGORY.FIRST.FROM AND Y.CATEGORY LE Y.SAVE.CATEGORY.FIRST.TO OR Y.CATEGORY GE Y.SAVE.CATEGORY.SECOND.FROM AND Y.CATEGORY LE Y.SAVE.CATEGORY.SECOND.TO
                IF Y.CATEGORY NE Y.CATEGORY.EXCLUDE.FROM.FIRST AND Y.CATEGORY NE Y.CATEGORY.EXCLUDE.TO.FIRST AND Y.CATEGORY NE Y.CATEGORY.EXCLUDE.FROM.SECOND THEN

                    Y.SAVE.SECOND.COUNT.RANGE = Y.SAVE.SECOND.COUNT.RANGE + 1
                END
*
            CASE Y.CATEGORY GE Y.TD.CATEGORY.FIRST.FROM AND Y.CATEGORY LE Y.TD.CATEGORY.FIRST.TO OR Y.CATEGORY EQ Y.TD.CATEGORY.SECOND.FROM OR Y.CATEGORY GE Y.TD.CATEGORY.THIRD.FROM AND Y.CATEGORY LE Y.TD.CATEGORY.THIRD.TO
                IF Y.CATEGORY NE Y.CATEGORY.EXCLUDE.FROM.FIRST AND Y.CATEGORY NE Y.CATEGORY.EXCLUDE.TO.FIRST AND Y.CATEGORY NE Y.CATEGORY.EXCLUDE.FROM.SECOND THEN
                    Y.TD.SECOND.COUNT.RANGE = Y.TD.SECOND.COUNT.RANGE + 1
                END
*
            END CASE
*
*--------------------------------------------------------------------------------------------------
*
        CASE Y.BALANCE GE Y.THIRD.RANGE.AMOUNT.FROM AND Y.BALANCE LE Y.THIRD.RANGE.AMOUNT.TO
*
            BEGIN CASE
*
            CASE Y.CATEGORY GE Y.CURR.CATEGORY.FIRST.FROM AND Y.CATEGORY LE Y.CURR.CATEGORY.FIRST.TO
                IF Y.CATEGORY NE Y.CATEGORY.EXCLUDE.FROM.FIRST AND Y.CATEGORY NE Y.CATEGORY.EXCLUDE.TO.FIRST AND Y.CATEGORY NE Y.CATEGORY.EXCLUDE.FROM.SECOND THEN
                    Y.CURR.THIRD.COUNT.RANGE = Y.CURR.THIRD.COUNT.RANGE + 1
                END
*
            CASE Y.CATEGORY GE Y.SAVE.CATEGORY.FIRST.FROM AND Y.CATEGORY LE Y.SAVE.CATEGORY.FIRST.TO OR Y.CATEGORY GE Y.SAVE.CATEGORY.SECOND.FROM AND Y.CATEGORY LE Y.SAVE.CATEGORY.SECOND.TO
                IF Y.CATEGORY NE Y.CATEGORY.EXCLUDE.FROM.FIRST AND Y.CATEGORY NE Y.CATEGORY.EXCLUDE.TO.FIRST AND Y.CATEGORY NE Y.CATEGORY.EXCLUDE.FROM.SECOND THEN
                    Y.SAVE.THIRD.COUNT.RANGE = Y.SAVE.THIRD.COUNT.RANGE + 1
                END
*
            CASE Y.CATEGORY GE Y.TD.CATEGORY.FIRST.FROM AND Y.CATEGORY LE Y.TD.CATEGORY.FIRST.TO OR Y.CATEGORY EQ Y.TD.CATEGORY.SECOND.FROM OR Y.CATEGORY GE Y.TD.CATEGORY.THIRD.FROM AND Y.CATEGORY LE Y.TD.CATEGORY.THIRD.TO
                IF Y.CATEGORY NE Y.CATEGORY.EXCLUDE.FROM.FIRST AND Y.CATEGORY NE Y.CATEGORY.EXCLUDE.TO.FIRST AND Y.CATEGORY NE Y.CATEGORY.EXCLUDE.FROM.SECOND THEN
                    Y.TD.THIRD.COUNT.RANGE = Y.TD.THIRD.COUNT.RANGE + 1
                END
*
            END CASE
*
*--------------------------------------------------------------------------------------------------
*
        CASE Y.BALANCE GE Y.FOURTH.RANGE.AMOUNT.FROM AND Y.BALANCE LE Y.FOURTH.RANGE.AMOUNT.TO
*
            BEGIN CASE
*
            CASE Y.CATEGORY GE Y.CURR.CATEGORY.FIRST.FROM AND Y.CATEGORY LE Y.CURR.CATEGORY.FIRST.TO
                IF Y.CATEGORY NE Y.CATEGORY.EXCLUDE.FROM.FIRST AND Y.CATEGORY NE Y.CATEGORY.EXCLUDE.TO.FIRST AND Y.CATEGORY NE Y.CATEGORY.EXCLUDE.FROM.SECOND THEN
                    Y.CURR.FOURTH.COUNT.RANGE = Y.CURR.FOURTH.COUNT.RANGE + 1
                END
*
            CASE Y.CATEGORY GE Y.SAVE.CATEGORY.FIRST.FROM AND Y.CATEGORY LE Y.SAVE.CATEGORY.FIRST.TO OR Y.CATEGORY GE Y.SAVE.CATEGORY.SECOND.FROM AND Y.CATEGORY LE Y.SAVE.CATEGORY.SECOND.TO
                IF Y.CATEGORY NE Y.CATEGORY.EXCLUDE.FROM.FIRST AND Y.CATEGORY NE Y.CATEGORY.EXCLUDE.TO.FIRST AND Y.CATEGORY NE Y.CATEGORY.EXCLUDE.FROM.SECOND THEN
                    Y.SAVE.FOURTH.COUNT.RANGE = Y.SAVE.FOURTH.COUNT.RANGE + 1
                END
*
            CASE Y.CATEGORY GE Y.TD.CATEGORY.FIRST.FROM AND Y.CATEGORY LE Y.TD.CATEGORY.FIRST.TO OR Y.CATEGORY EQ Y.TD.CATEGORY.SECOND.FROM OR Y.CATEGORY GE Y.TD.CATEGORY.THIRD.FROM AND Y.CATEGORY LE Y.TD.CATEGORY.THIRD.TO
                IF Y.CATEGORY NE Y.CATEGORY.EXCLUDE.FROM.FIRST AND Y.CATEGORY NE Y.CATEGORY.EXCLUDE.TO.FIRST AND Y.CATEGORY NE Y.CATEGORY.EXCLUDE.FROM.SECOND THEN
                    Y.TD.FOURTH.COUNT.RANGE = Y.TD.FOURTH.COUNT.RANGE + 1
                END
*
            END CASE
*
*--------------------------------------------------------------------------------------------------
*
        CASE Y.BALANCE GE Y.FIFTH.RANGE.AMOUNT.FROM AND Y.BALANCE LE Y.FIFTH.RANGE.AMOUNT.TO
*
            BEGIN CASE
*
            CASE Y.CATEGORY GE Y.CURR.CATEGORY.FIRST.FROM AND Y.CATEGORY LE Y.CURR.CATEGORY.FIRST.TO
                IF Y.CATEGORY NE Y.CATEGORY.EXCLUDE.FROM.FIRST AND Y.CATEGORY NE Y.CATEGORY.EXCLUDE.TO.FIRST AND Y.CATEGORY NE Y.CATEGORY.EXCLUDE.FROM.SECOND THEN
                    Y.CURR.FIFTH.COUNT.RANGE = Y.CURR.FIFTH.COUNT.RANGE + 1
                END
*
            CASE Y.CATEGORY GE Y.SAVE.CATEGORY.FIRST.FROM AND Y.CATEGORY LE Y.SAVE.CATEGORY.FIRST.TO OR Y.CATEGORY GE Y.SAVE.CATEGORY.SECOND.FROM AND Y.CATEGORY LE Y.SAVE.CATEGORY.SECOND.TO
                IF Y.CATEGORY NE Y.CATEGORY.EXCLUDE.FROM.FIRST AND Y.CATEGORY NE Y.CATEGORY.EXCLUDE.TO.FIRST AND Y.CATEGORY NE Y.CATEGORY.EXCLUDE.FROM.SECOND THEN
                    Y.SAVE.FIFTH.COUNT.RANGE = Y.SAVE.FIFTH.COUNT.RANGE + 1
                END
*
            CASE Y.CATEGORY GE Y.TD.CATEGORY.FIRST.FROM AND Y.CATEGORY LE Y.TD.CATEGORY.FIRST.TO OR Y.CATEGORY EQ Y.TD.CATEGORY.SECOND.FROM OR Y.CATEGORY GE Y.TD.CATEGORY.THIRD.FROM AND Y.CATEGORY LE Y.TD.CATEGORY.THIRD.TO
                IF Y.CATEGORY NE Y.CATEGORY.EXCLUDE.FROM.FIRST AND Y.CATEGORY NE Y.CATEGORY.EXCLUDE.TO.FIRST AND Y.CATEGORY NE Y.CATEGORY.EXCLUDE.FROM.SECOND THEN
                    Y.TD.FIFTH.COUNT.RANGE = Y.TD.FIFTH.COUNT.RANGE + 1
                END
*
            END CASE
*
*--------------------------------------------------------------------------------------------------
*
        CASE Y.BALANCE GE Y.SIXTH.RANGE.AMOUNT.FROM
*
            BEGIN CASE
*
            CASE Y.CATEGORY GE Y.CURR.CATEGORY.FIRST.FROM AND Y.CATEGORY LE Y.CURR.CATEGORY.FIRST.TO
                IF Y.CATEGORY NE Y.CATEGORY.EXCLUDE.FROM.FIRST AND Y.CATEGORY NE Y.CATEGORY.EXCLUDE.TO.FIRST AND Y.CATEGORY NE Y.CATEGORY.EXCLUDE.FROM.SECOND THEN
                    Y.CURR.SIXTH.COUNT.RANGE = Y.CURR.SIXTH.COUNT.RANGE + 1
                END
*
            CASE Y.CATEGORY GE Y.SAVE.CATEGORY.FIRST.FROM AND Y.CATEGORY LE Y.SAVE.CATEGORY.FIRST.TO OR Y.CATEGORY GE Y.SAVE.CATEGORY.SECOND.FROM AND Y.CATEGORY LE Y.SAVE.CATEGORY.SECOND.TO
                IF Y.CATEGORY NE Y.CATEGORY.EXCLUDE.FROM.FIRST AND Y.CATEGORY NE Y.CATEGORY.EXCLUDE.TO.FIRST AND Y.CATEGORY NE Y.CATEGORY.EXCLUDE.FROM.SECOND THEN
                    Y.SAVE.SIXTH.COUNT.RANGE = Y.SAVE.SIXTH.COUNT.RANGE + 1
                END
*
            CASE Y.CATEGORY GE Y.TD.CATEGORY.FIRST.FROM AND Y.CATEGORY LE Y.TD.CATEGORY.FIRST.TO OR Y.CATEGORY EQ Y.TD.CATEGORY.SECOND.FROM OR Y.CATEGORY GE Y.TD.CATEGORY.THIRD.FROM AND Y.CATEGORY LE Y.TD.CATEGORY.THIRD.TO
                IF Y.CATEGORY NE Y.CATEGORY.EXCLUDE.FROM.FIRST AND Y.CATEGORY NE Y.CATEGORY.EXCLUDE.TO.FIRST AND Y.CATEGORY NE Y.CATEGORY.EXCLUDE.FROM.SECOND THEN
                    Y.TD.SIXTH.COUNT.RANGE = Y.TD.SIXTH.COUNT.RANGE + 1
                END
*
            END CASE
*--------------------------------------------------------------------------------------------------
*
        CASE NO.OF.REC EQ 0
            Y.ARR<-1> = 'NO RECORDS SELECTED'
            Y.ARR = "NO"
            PRINT "CASE EXECUTED"
        END CASE
*
    REPEAT
*
    RETURN
*
*--------------------------------------------------------------------------------------------------
RECORDS.COUNT:
*--------------------------------------------------------------------------------------------------
* The counts of Each account is been stored in an array in this section
*--------------------------------------------------------------------------------------------------
*
    Y.CURRENT.COUNT<-1> = Y.CURR.FIRST.COUNT.RANGE:@VM:Y.CURR.SECOND.COUNT.RANGE:@VM:Y.CURR.THIRD.COUNT.RANGE:@VM:Y.CURR.FOURTH.COUNT.RANGE:@VM:Y.CURR.FIFTH.COUNT.RANGE:@VM:Y.CURR.SIXTH.COUNT.RANGE
*
    Y.SAVE.COUNT<-1> = Y.SAVE.FIRST.COUNT.RANGE:@VM:Y.SAVE.SECOND.COUNT.RANGE:@VM:Y.SAVE.THIRD.COUNT.RANGE:@VM:Y.SAVE.FOURTH.COUNT.RANGE:@VM:Y.SAVE.FIFTH.COUNT.RANGE:@VM:Y.SAVE.SIXTH.COUNT.RANGE
*
    Y.TD.COUNT<-1> = Y.TD.FIRST.COUNT.RANGE:@VM:Y.TD.SECOND.COUNT.RANGE:@VM:Y.TD.THIRD.COUNT.RANGE:@VM:Y.TD.FOURTH.COUNT.RANGE:@VM:Y.TD.FIFTH.COUNT.RANGE:@VM:Y.TD.SIXTH.COUNT.RANGE
*
    Y.RANGE<-1> = Y.FIRST.RANGE:@VM:Y.SECOND.RANGE:@VM:Y.THIRD.RANGE:@VM:Y.FOURTH.RANGE:@VM:Y.FIFTH.RANGE:@VM:Y.SIXTH.RANGE
*
    Y.RATE.RANGE<-1> = Y.RATE.FIRST.RANGE:@VM:Y.RATE.SECOND.RANGE:@VM:Y.RATE.THIRD.RANGE:@VM:Y.RATE.FOURTH.RANGE:@VM:Y.RATE.FIFTH.RANGE:@VM:Y.RATE.SIXTH.RANGE
*
*--------------------------------------------------------------------------------------------------
    Y.ARR<-1> = Y.RANGE:"*":Y.CURRENT.COUNT:"*":Y.SAVE.COUNT:"*":Y.TD.COUNT:"*":Y.RATE.RANGE
    IF NO.OF.REC EQ 0 THEN Y.ARR = 'NO RECORDS SELECTED'
*--------------------------------------------------------------------------------------------------
    RETURN
*--------------------------------------------------------------------------------------------------
END
