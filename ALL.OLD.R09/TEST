    PROGRAM TEST
    $INSERT GLOBUS.BP I_COMMON
    $INSERT GLOBUS.BP I_EQUATE
    $INSERT JBL.BP I_F.BD.SDSA.AC.REFNO
    $INSERT JBL.BP I_F.BD.SDSA.ENTRY.DETAILS

    FN.SD.REF = 'F.BD.SDSA.AC.REFNO'
    F.SD.REF =''
    FN.SD.DET = 'F.BD.SDSA.ENTRY.DETAILS'
    F.SD.DET = ''
    J=0
    CALL OPF(FN.SD.REF,F.SD.REF)
    CALL OPF(FN.SD.DET,F.SD.DET)
    SEL.CMD ="SELECT ":FN.SD.REF
    CALL EB.READLIST(SEL.CMD,SEL.LIST,'',NO.OF.REC,RET.CODE)
    LOOP
        REMOVE Y.ID FROM SEL.LIST SETTING POS
    WHILE Y.ID:POS
        CALL F.READ(FN.SD.REF,Y.ID,R.REF,F.SD.REF,Y.ERR.SD.REF)
        Y.REF.ID = Y.ID
        Y.REF = R.REF<BD.SDSA.AC.SDSA.REF.NO>
        Y.CNT.REF = DCOUNT(Y.REF,@VM)
        FOR I = 1 TO Y.CNT.REF
            Y.TRANS.REF.NO = R.REF<BD.SDSA.AC.SDSA.REF.NO,I>
            CALL F.READ(FN.SD.DET,Y.TRANS.REF.NO,R.SD.DET,F.SD.DET,Y.SD.DET.ERR)
            IF R.SD.DET NE '' THEN
                Y.SDSA.REF = Y.TRANS.REF.NO
                Y.AC.NO = R.SD.DET<BD.SDSA.AC.NUMBER>
                Y.AC.TYPE = R.SD.DET<BD.SDSA.AC.TYPE>
                Y.CO.CODE = R.SD.DET<BD.SDSA.CO.CODE>
            END ELSE
                Y.SDSA.REF = Y.TRANS.REF.NO
                Y.AC.NO = R.SD.DET<BD.SDSA.AC.NUMBER>
                Y.AC.TYPE = R.SD.DET<BD.SDSA.AC.TYPE>
                Y.CO.CODE = R.SD.DET<BD.SDSA.CO.CODE>
            END
!Y.DATA<-1> = Y.REF.ID:'*':Y.SDSA.REF:'*':Y.AC.NO:'*':Y.AC.TYPE:'*':Y.CO.CODE
            CRT Y.REF.ID:'*':Y.SDSA.REF:'*':Y.AC.NO:'*':Y.AC.TYPE:'*':Y.CO.CODE
            J++
        NEXT I
    REPEAT
CRT J
END
