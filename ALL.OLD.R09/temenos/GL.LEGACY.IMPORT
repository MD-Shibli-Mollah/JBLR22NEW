*-----------------------------------------------------------------------------
* <Rating>300</Rating>
*-----------------------------------------------------------------------------
    SUBROUTINE GL.LEGACY.IMPORT
    $INSERT I_COMMON
    $INSERT I_EQUATE
    $INCLUDE BP I_F.GL.REPORT.PARAMETER
    OPENSEQ '/t24apptest/jbllivetest1/bnk/bnk.run/JBL.BP/back.csv' TO TEST.FILE ELSE CREATE TEST.FILE ELSE PRINT "ERROR"
    FN.GL.REPORT.PARAM = "F.GL.REPORT.PARAMETER"
    F.GL.REPORT.PARAMETER = ""
    CALL OPF(FN.GL.REPORT.PARAM,F.GL.REPORT.PARAMETER)
    CALL F.READ(FN.GL.REPORT.PARAM,'SOABP',R.REC,F.GL.REPORT.PARAMETER,Y.ERR)
    Y.COUNT = DCOUNT(R.REC<GL.ENQ.REP.GL.CODE>,@VM) + 1
    LOOP
        READSEQ L.VALUES FROM TEST.FILE ELSE BREAK
        GL.CODE = FIELD(L.VALUES,',',1,1)
        LEGACY.ID = FIELD(L.VALUES,',',2,1)
        GL.TYPE = FIELD(L.VALUES,',',3,1)
        DESCRIPTION = FIELD(L.VALUES,',',4,1)
        ACCUMULATOR = FIELD(L.VALUES,',',5,1)
        R.REC<GL.ENQ.REP.GL.CODE,Y.COUNT> = GL.CODE
        R.REC<GL.ENQ.REP.LEGACY.ID,Y.COUNT> = LEGACY.ID
        R.REC<GL.ENQ.REP.GL.TYPE,Y.COUNT> = GL.TYPE
        R.REC<GL.ENQ.REP.DESCRIP,Y.COUNT> = DESCRIPTION
        R.REC<GL.ENQ.REP.ACCUMULATOR,Y.COUNT> = ACCUMULATOR
        CALL F.WRITE(FN.GL.REPORT.PARAM,'SOABP',R.REC)
        Y.COUNT = Y.COUNT + 1
    REPEAT
    CALL JOURNAL.UPDATE('SOABP')
    CLOSESEQ TEST.FILE
    RETURN
END
