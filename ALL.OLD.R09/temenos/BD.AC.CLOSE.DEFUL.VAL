    SUBROUTINE BD.AC.CLOSE.DEFUL.VAL
    $INSERT GLOBUS.BP I_COMMON
    $INSERT GLOBUS.BP I_EQUATE
    $INSERT GLOBUS.BP I_F.FUNDS.TRANSFER
    $INSERT GLOBUS.BP I_F.COMPANY

    GOSUB INITIALISE
    GOSUB PROCESS

    RETURN

INITIALISE:
    FN.FT = 'F.FUNDS.TRANSFER'
    F.FT = ''
    CALL OPF(FN.FT,F.FT)

    RETURN

PROCESS:
    Y.FT.ID =ID.NEW
    CALL F.READ(FN.FT,Y.FT.ID,R.FT.REC,F.FT,Y.FT.ERR)
    IF R.NEW(FT.CREDIT.ACCT.NO) EQ "" THEN
        R.NEW(FT.CREDIT.ACCT.NO)= R.NEW(FT.DEBIT.ACCT.NO)
    END
    IF R.NEW(FT.CREDIT.CURRENCY) EQ "" THEN
        R.NEW(FT.CREDIT.CURRENCY)= R.NEW(FT.DEBIT.CURRENCY)
    END
    IF R.NEW(FT.CREDIT.AMOUNT) EQ "" THEN
        R.NEW(FT.CREDIT.AMOUNT)= R.NEW(FT.DEBIT.AMOUNT)
    END
    IF R.NEW(FT.TRANSACTION.TYPE) EQ "BC" OR R.NEW(FT.TRANSACTION.TYPE) EQ "" THEN
        R.NEW(FT.TRANSACTION.TYPE)  = 'AC'
    END
!R.NEW(FT.BEN.CUSTOMER) = ''
!R.NEW(FT.DEBIT.ACCT.NO) = ''
!R.NEW(FT.DEBIT.CURRENCY) = ''
!R.NEW(FT.DEBIT.AMOUNT) = ''

    RETURN
END
