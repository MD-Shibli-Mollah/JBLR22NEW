    PROGRAM ALL.ACI.LIST

    $INSERT GLOBUS.BP I_COMMON
    $INSERT GLOBUS.BP I_EQUATE
    $INSERT GLOBUS.BP I_F.ACCOUNT
    $INSERT GLOBUS.BP I_F.ACCOUNT.CREDIT.INT

    GOSUB INIT
    GOSUB OPENFILES
    GOSUB PROCESS

INIT:
****
*CRT "INIT"
    FN.AC = "FBNK.ACCOUNT"
    FP.AC = ""

    FN.ACI = "FBNK.ACCOUNT.CREDIT.INT"
    FP.ACI = ""

    Y.ATM.DIR = 'ITD.BP'
    Y.ATM.FILE = 'ACILIST' :'.txt'
    F.FILE.POINT = ''
    Y.MSG.STR = ''
    OPENSEQ Y.ATM.DIR,Y.ATM.FILE TO F.FILE.POINT ELSE NULL

    RETURN

OPENFILES:
**********
*CRT "OPEN FILE"
    CALL OPF(FN.AC, FP.AC)
    CALL OPF(FN.ACI, FP.ACI)
    RETURN

PROCESS:
********


    SEL.CMD = "SELECT FBNK.ACCOUNT.CREDIT.INT "
    CALL EB.READLIST(SEL.CMD, SEL.ACI, '', REC.ACI, ERR.ACI)
    LOOP
        REMOVE Y.AC.ID FROM SEL.ACI SETTING POS
    WHILE Y.AC.ID:POS
        T24.ID = FIELD(Y.AC.ID, "-", 1)
        EFF.DT = FIELD(Y.AC.ID, "-", 2)

        CALL F.READ(FN.AC, T24.ID, R.AC.ID, FP.AC, ERR.AC)
        AC.TIT = R.AC.ID<AC.ACCOUNT.TITLE.1>
        ALT.ID = R.AC.ID<AC.ALT.ACCT.ID>
        CATG = R.AC.ID<AC.CATEGORY>
* CRT T24.ID
* CRT ALT.ID
*  CRT AC.TIT
* CRT EFF.DT

        CALL F.READ(FN.ACI, Y.AC.ID, R.ACI, FP.ACI, ERR.ACI1)
        TX     = R.ACI<IC.ACI.TAX.KEY>
        INP    = R.ACI<IC.ACI.INPUTTER>
        AUT    = R.ACI<IC.ACI.AUTHORISER>
        INTR   = R.ACI<IC.ACI.CR.INT.RATE>
        COCD   = R.ACI<IC.ACI.CO.CODE>
*CRT TX
* CRT INP
* CRT AUT
* CRT INTR
* CRT COCD
        Y.MSG.STR = T24.ID : "~": ALT.ID : "~": AC.TIT : "~": EFF.DT : "~": TX : "~": INP : "~": AUT : "~": INTR : "~": COCD : "~" : CATG

        GOSUB TEXTFILE.WRITE
    REPEAT

    Y.MSG.STR = ""

    RETURN          ;****** END PROCESS


TEXTFILE.WRITE:
** ============
    WRITESEQ Y.MSG.STR APPEND TO F.FILE.POINT ELSE NULL
    RETURN

    RETURN
END
