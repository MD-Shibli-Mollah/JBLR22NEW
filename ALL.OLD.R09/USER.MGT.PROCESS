    SUBROUTINE USER.MGT.PROCESS
!PROGRAM USER.MGT.PROCESS
    $INSERT GLOBUS.BP I_COMMON
    $INSERT GLOBUS.BP I_EQUATE
    $INSERT BP I_F.USER.MGT
    $INSERT GLOBUS.BP I_F.USER

!DEBUG
    FN.USER.MGT = 'F.EB.USER.MGT'
    F.USER.MGT = ''
    FN.USER = 'F.USER'
    F.USER = ''
    CALL OPF(FN.USER.MGT,F.USER.MGT)
    CALL OPF(FN.USER,F.USER)

    Y.ID = ID.NEW
    Y.BANK.ID =RIGHT(LEFT(Y.ID,8),6)

    CALL F.READ(FN.USER,Y.ID,R.USER.ID,F.USER,USER.ERR)

    IF R.USER.ID NE '' THEN
        SEL.CMD = 'SELECT ' :FN.USER.MGT: ' WITH USER.ID EQ ': Y.ID
    END
    ELSE
        SEL.CMD = 'SELECT ' :FN.USER.MGT: ' WITH EMP.BANK.ID EQ ': Y.BANK.ID
    END
    CALL EB.READLIST(SEL.CMD,SEL.LIST,'',NO.OF.REC,RECT.CODE)
    REMOVE Y.REQ.ID FROM SEL.LIST SETTING ID.POS
    CALL F.READ(FN.USER.MGT,Y.REQ.ID,R.USER.MGT,F.USER.MGT,ERR.USER)
    R.USER.MGT<EB.USE61.REQUEST.STATUS> = 'PROCESSING'
    R.USER.MGT<EB.USE61.REQUEST.DATE.TIME> = LEFT(R.USER.MGT<EB.USE61.DATE.TIME>,6)
    CALL F.WRITE(FN.USER.MGT,Y.REQ.ID,R.USER.MGT)
!CALL JOURNAL.UPDATE('')
    RETURN
END
